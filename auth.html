<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ZERIONX1 · institutional trading platform</title>
  
  <!-- SUPABASE -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
  
  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Font Awesome 6 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Inter - professional font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      background: #0B0E14;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      color: #E2E8F0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1.5rem;
    }
    
    /* clean, premium card */
    .premium-card {
      background: #161B22;
      border: 1px solid #2D333B;
      border-radius: 32px;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
      width: 100%;
      max-width: 480px;
      transition: border-color 0.2s ease;
    }
    
    .premium-card:hover {
      border-color: #3D4450;
    }
    
    /* brand header */
    .brand-section {
      text-align: center;
      padding: 2rem 2rem 1.5rem 2rem;
      border-bottom: 1px solid #2D333B;
    }
    
    .brand-title {
      font-size: 2.5rem;
      font-weight: 700;
      letter-spacing: -0.02em;
      color: #FFFFFF;
      margin-bottom: 0.25rem;
    }
    
    .brand-accent {
      color: #C19A5B;
      font-weight: 700;
    }
    
    .brand-subtitle {
      color: #8B949E;
      font-size: 0.875rem;
      font-weight: 400;
      letter-spacing: 0.3px;
    }
    
    /* tabs */
    .tab-container {
      display: flex;
      padding: 0 2rem;
      gap: 2rem;
      border-bottom: 1px solid #2D333B;
    }
    
    .tab-item {
      padding: 1rem 0 0.75rem 0;
      font-weight: 500;
      font-size: 0.95rem;
      color: #8B949E;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      transition: all 0.2s;
      letter-spacing: 0.3px;
    }
    
    .tab-item.active {
      color: #C19A5B;
      border-bottom-color: #C19A5B;
    }
    
    /* form container */
    .form-container {
      padding: 2rem;
    }
    
    /* input fields - clean & professional */
    .input-wrapper {
      margin-bottom: 1.25rem;
    }
    
    .input-field {
      width: 100%;
      background: #1C2128;
      border: 1px solid #2D333B;
      border-radius: 12px;
      padding: 0.875rem 1rem;
      color: #E2E8F0;
      font-size: 0.95rem;
      transition: all 0.2s;
      font-family: 'Inter', sans-serif;
    }
    
    .input-field:focus {
      outline: none;
      border-color: #C19A5B;
      background: #222832;
    }
    
    .input-field::placeholder {
      color: #6E7681;
      font-weight: 400;
    }
    
    /* input with icon */
    .input-icon-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }
    
    .input-icon {
      position: absolute;
      left: 1rem;
      color: #8B949E;
      font-size: 1rem;
    }
    
    .input-icon-field {
      width: 100%;
      background: #1C2128;
      border: 1px solid #2D333B;
      border-radius: 12px;
      padding: 0.875rem 1rem 0.875rem 2.75rem;
      color: #E2E8F0;
      font-size: 0.95rem;
      transition: all 0.2s;
      font-family: 'Inter', sans-serif;
    }
    
    .input-icon-field:focus {
      outline: none;
      border-color: #C19A5B;
      background: #222832;
    }
    
    .input-icon-field::placeholder {
      color: #6E7681;
    }
    
    /* password toggle */
    .password-toggle {
      position: absolute;
      right: 1rem;
      color: #8B949E;
      cursor: pointer;
      transition: color 0.2s;
    }
    
    .password-toggle:hover {
      color: #C19A5B;
    }
    
    /* primary button - gold */
    .btn-primary {
      width: 100%;
      background: #C19A5B;
      border: none;
      border-radius: 12px;
      padding: 1rem;
      color: #0B0E14;
      font-weight: 600;
      font-size: 1rem;
      letter-spacing: 0.3px;
      cursor: pointer;
      transition: all 0.2s;
      margin-top: 0.5rem;
      font-family: 'Inter', sans-serif;
    }
    
    .btn-primary:hover:not(:disabled) {
      background: #D4AF37;
      transform: translateY(-1px);
      box-shadow: 0 8px 20px -8px rgba(193, 154, 91, 0.3);
    }
    
    .btn-primary:active:not(:disabled) {
      transform: translateY(0);
    }
    
    .btn-primary:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    
    /* secondary text */
    .text-footnote {
      display: flex;
      justify-content: space-between;
      margin-top: 1.25rem;
      color: #6E7681;
      font-size: 0.75rem;
    }
    
    .text-footnote i {
      color: #8B949E;
      margin-right: 0.375rem;
    }
    
    /* message panel */
    .message-panel {
      margin: 0 2rem 1rem 2rem;
      padding: 0.875rem 1.25rem;
      border-radius: 12px;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      background: #1C2128;
      border: 1px solid #2D333B;
    }
    
    .message-panel.success {
      background: #1A2A1F;
      border-color: #347D39;
      color: #B5F0B5;
    }
    
    .message-panel.success i {
      color: #3FB950;
    }
    
    .message-panel.error {
      background: #2D1F1F;
      border-color: #A14545;
      color: #FFB5B5;
    }
    
    .message-panel.error i {
      color: #F97575;
    }
    
    /* error display (from screenshot) */
    .error-card {
      margin: 0 2rem 1.5rem 2rem;
      padding: 2rem 1.5rem;
      background: #1C2128;
      border: 1px solid #A14545;
      border-radius: 20px;
      text-align: center;
    }
    
    .error-icon-large {
      font-size: 2.5rem;
      color: #F97575;
      margin-bottom: 1rem;
    }
    
    .error-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: #FFB5B5;
      margin-bottom: 0.5rem;
    }
    
    .error-message {
      color: #ADBAC7;
      font-size: 0.9rem;
      margin-bottom: 1rem;
    }
    
    .error-code {
      color: #8B949E;
      font-size: 0.7rem;
      font-family: monospace;
      letter-spacing: 0.5px;
    }
    
    /* divider */
    .divider {
      height: 1px;
      background: #2D333B;
      margin: 1.5rem 2rem 1rem 2rem;
    }
    
    /* footer */
    .footer-stats {
      display: flex;
      justify-content: space-between;
      padding: 1rem 2rem 2rem 2rem;
      color: #6E7681;
      font-size: 0.7rem;
    }
    
    .footer-stats span i {
      margin-right: 0.375rem;
      color: #8B949E;
    }
    
    .hidden {
      display: none !important;
    }
    
    /* badge */
    .badge {
      background: rgba(193, 154, 91, 0.1);
      border: 1px solid rgba(193, 154, 91, 0.3);
      border-radius: 100px;
      padding: 0.2rem 1rem;
      font-size: 0.65rem;
      color: #C19A5B;
      display: inline-block;
      margin-left: 0.5rem;
      vertical-align: middle;
    }
  </style>
</head>
<body>

<div class="premium-card">

  <!-- brand header - clean premium -->
  <div class="brand-section">
    <div class="brand-title">
      ZERION<span class="brand-accent">X1</span>
      <span class="badge">v2.5.0</span>
    </div>
    <div class="brand-subtitle">institutional trading platform</div>
  </div>

  <!-- tabs - simple & professional -->
  <div class="tab-container">
    <div id="loginTab" class="tab-item active">LOGIN</div>
    <div id="signupTab" class="tab-item">CREATE ACCOUNT</div>
  </div>

  <!-- message area (dynamic) -->
  <div id="messagePanel" class="message-panel hidden">
    <i id="messageIcon" class="fa-regular fa-circle-check"></i>
    <span id="messageText"></span>
  </div>

  <!-- error card (from screenshot) -->
  <div id="errorCard" class="error-card hidden">
    <div class="error-icon-large">
      <i class="fa-regular fa-circle-exclamation"></i>
    </div>
    <div class="error-title">Data Error</div>
    <div class="error-message">Unable to load user data. Please contact support.</div>
    <div class="error-code">ERROR · ZERIONX1-4O2</div>
  </div>

  <!-- LOGIN FORM -->
  <form id="loginForm" class="form-container">

    <div class="input-icon-wrapper">
      <i class="fa-regular fa-envelope input-icon"></i>
      <input type="email" id="loginEmail" class="input-icon-field" placeholder="Email address" required>
    </div>

    <div class="input-icon-wrapper" style="margin-top: 1rem;">
      <i class="fa-solid fa-lock input-icon"></i>
      <input type="password" id="loginPassword" class="input-icon-field" placeholder="Password" required>
      <i id="toggleLoginPass" class="fa-regular fa-eye password-toggle"></i>
    </div>

    <button type="submit" id="loginBtn" class="btn-primary">
      <i class="fa-regular fa-arrow-right-to-bracket" style="margin-right: 0.5rem;"></i>
      Access Terminal
    </button>

    <div class="text-footnote">
      <span><i class="fa-regular fa-shield-check"></i> 2FA protected</span>
      <span><i class="fa-regular fa-clock"></i> session timeout 15min</span>
    </div>
  </form>

  <!-- SIGNUP FORM -->
  <form id="signupForm" class="form-container hidden">

    <div class="input-icon-wrapper">
      <i class="fa-regular fa-user input-icon"></i>
      <input type="text" id="name" class="input-icon-field" placeholder="Full name" required>
    </div>

    <div class="input-icon-wrapper" style="margin-top: 1rem;">
      <i class="fa-regular fa-envelope input-icon"></i>
      <input type="email" id="email" class="input-icon-field" placeholder="Email address" required>
    </div>

    <div class="input-icon-wrapper" style="margin-top: 1rem;">
      <i class="fa-regular fa-phone input-icon"></i>
      <input type="tel" id="phone" class="input-icon-field" placeholder="Phone number" required>
    </div>

    <div class="input-icon-wrapper" style="margin-top: 1rem;">
      <i class="fa-solid fa-lock input-icon"></i>
      <input type="password" id="password" class="input-icon-field" placeholder="Password" required>
      <i id="togglePass" class="fa-regular fa-eye password-toggle"></i>
    </div>

    <button type="submit" id="signupBtn" class="btn-primary">
      <i class="fa-regular fa-user-plus" style="margin-right: 0.5rem;"></i>
      Create Account
    </button>

    <div class="text-footnote">
      <span><i class="fa-regular fa-envelope"></i> verification required</span>
      <span><i class="fa-regular fa-key"></i> institutional access</span>
    </div>
  </form>

  <div class="divider"></div>

  <!-- footer - clean stats -->
  <div class="footer-stats">
    <span><i class="fa-regular fa-chart-line"></i> VWAP · 0.02%</span>
    <span><i class="fa-regular fa-microchip"></i> engine v3</span>
    <span><i class="fa-regular fa-gauge-high"></i> 0.1ms latency</span>
  </div>
</div>

<script>
  (function() {
    // ========== SUPABASE INIT ==========
    const SUPABASE_URL = "https://dpmqjvaylnszykujmufv.supabase.co";
    const SUPABASE_KEY = "sb_publishable_S2HHT0VP1Ru6Dk63ju7V-Q_FnNfX1sd";
    const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY, {
      auth: { persistSession: true }
    });

    // ========== DOM ELEMENTS ==========
    const loginTab = document.getElementById('loginTab');
    const signupTab = document.getElementById('signupTab');
    const loginForm = document.getElementById('loginForm');
    const signupForm = document.getElementById('signupForm');
    
    const messagePanel = document.getElementById('messagePanel');
    const messageIcon = document.getElementById('messageIcon');
    const messageText = document.getElementById('messageText');
    const errorCard = document.getElementById('errorCard');

    // login elements
    const loginEmail = document.getElementById('loginEmail');
    const loginPassword = document.getElementById('loginPassword');
    const loginBtn = document.getElementById('loginBtn');
    const toggleLoginPass = document.getElementById('toggleLoginPass');

    // signup elements
    const nameField = document.getElementById('name');
    const emailField = document.getElementById('email');
    const phoneField = document.getElementById('phone');
    const passwordField = document.getElementById('password');
    const signupBtn = document.getElementById('signupBtn');
    const togglePass = document.getElementById('togglePass');

    // ========== HELPER FUNCTIONS ==========
    function showMessage(text, isError = false) {
      errorCard.classList.add('hidden');
      messagePanel.classList.remove('hidden', 'success', 'error');
      
      if (isError) {
        messagePanel.classList.add('error');
        messageIcon.className = 'fa-regular fa-circle-exclamation';
      } else {
        messagePanel.classList.add('success');
        messageIcon.className = 'fa-regular fa-circle-check';
      }
      
      messageText.textContent = text;
      
      // auto hide success messages after 4 seconds
      if (!isError) {
        setTimeout(() => {
          messagePanel.classList.add('hidden');
        }, 4000);
      }
    }

    function showErrorCard() {
      messagePanel.classList.add('hidden');
      errorCard.classList.remove('hidden');
    }

    function hideAllMessages() {
      messagePanel.classList.add('hidden');
      errorCard.classList.add('hidden');
    }

    // ========== TAB SWITCHING ==========
    loginTab.addEventListener('click', () => {
      loginForm.classList.remove('hidden');
      signupForm.classList.add('hidden');
      loginTab.classList.add('active');
      signupTab.classList.remove('active');
      hideAllMessages();
    });

    signupTab.addEventListener('click', () => {
      signupForm.classList.remove('hidden');
      loginForm.classList.add('hidden');
      signupTab.classList.add('active');
      loginTab.classList.remove('active');
      hideAllMessages();
    });

    // ========== PASSWORD TOGGLE ==========
    function setupPasswordToggle(icon, input) {
      icon.addEventListener('click', (e) => {
        e.preventDefault();
        const type = input.type === 'password' ? 'text' : 'password';
        input.type = type;
        icon.classList.toggle('fa-eye');
        icon.classList.toggle('fa-eye-slash');
      });
    }
    
    setupPasswordToggle(togglePass, passwordField);
    setupPasswordToggle(toggleLoginPass, loginPassword);

    // ========== CHECK SESSION ==========
    (async () => {
      try {
        const { data: { session }, error } = await supabaseClient.auth.getSession();
        
        if (error) {
          console.error('Session error:', error);
          showErrorCard();
          return;
        }
        
        if (session) {
          window.location.href = 'dashboard.html';
        }
      } catch (err) {
        console.error('Failed to load session:', err);
        showErrorCard();
      }
    })();

    // ========== SIGNUP HANDLER ==========
    signupForm.addEventListener('submit', async (e) => {
      e.preventDefault();

      // validation
      if (!nameField.value.trim() || !emailField.value.trim() || !phoneField.value.trim() || !passwordField.value) {
        showMessage('All fields are required', true);
        return;
      }

      signupBtn.disabled = true;
      signupBtn.innerHTML = '<i class="fa-regular fa-spinner fa-spin" style="margin-right: 0.5rem;"></i> Creating...';

      try {
        const { error } = await supabaseClient.auth.signUp({
          email: emailField.value.trim(),
          password: passwordField.value,
          options: {
            data: {
              full_name: nameField.value.trim(),
              phone: phoneField.value.trim()
            }
          }
        });

        if (error) {
          showMessage(error.message, true);
          signupBtn.disabled = false;
          signupBtn.innerHTML = '<i class="fa-regular fa-user-plus" style="margin-right: 0.5rem;"></i> Create Account';
          return;
        }

        showMessage('Account created! Please verify your email.');
        
        // switch to login tab after 2 seconds
        setTimeout(() => {
          loginTab.click();
          loginEmail.value = emailField.value.trim();
        }, 2000);

      } catch (err) {
        showMessage('Connection error', true);
      } finally {
        signupBtn.disabled = false;
        signupBtn.innerHTML = '<i class="fa-regular fa-user-plus" style="margin-right: 0.5rem;"></i> Create Account';
      }
    });

    // ========== LOGIN HANDLER ==========
    loginForm.addEventListener('submit', async (e) => {
      e.preventDefault();

      const email = loginEmail.value.trim();
      const password = loginPassword.value;

      if (!email || !password) {
        showMessage('Please enter email and password', true);
        return;
      }

      loginBtn.disabled = true;
      loginBtn.innerHTML = '<i class="fa-regular fa-spinner fa-spin" style="margin-right: 0.5rem;"></i> Authenticating...';

      try {
        const { error } = await supabaseClient.auth.signInWithPassword({
          email: email,
          password: password
        });

        if (error) {
          if (error.message.includes('Email not confirmed')) {
            showMessage('Please verify your email first', true);
          } else {
            showMessage(error.message, true);
          }
          loginBtn.disabled = false;
          loginBtn.innerHTML = '<i class="fa-regular fa-arrow-right-to-bracket" style="margin-right: 0.5rem;"></i> Access Terminal';
          return;
        }

        showMessage('Access granted. Redirecting...');
        
        setTimeout(() => {
          window.location.href = 'dashboard.html';
        }, 1200);

      } catch (err) {
        showMessage('Authentication failed', true);
        loginBtn.disabled = false;
        loginBtn.innerHTML = '<i class="fa-regular fa-arrow-right-to-bracket" style="margin-right: 0.5rem;"></i> Access Terminal';
      }
    });

    // hide messages when typing
    [loginEmail, loginPassword, nameField, emailField, phoneField, passwordField].forEach(field => {
      if (field) {
        field.addEventListener('input', hideAllMessages);
      }
    });

  })();
</script>

</body>
</html>
