<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>ZERIONX1 | Secure Access</title>

<!-- Supabase CDN -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:'Inter',sans-serif;
}

body{
    background:#0b0f19;
    height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    color:white;
}

/* Background Glow */
body::before{
    content:"";
    position:absolute;
    width:500px;
    height:500px;
    background:#f5b94220;
    filter:blur(150px);
    border-radius:50%;
}

/* Card */
.auth-card{
    width:380px;
    background:rgba(20,25,40,0.75);
    backdrop-filter:blur(18px);
    padding:35px;
    border-radius:16px;
    box-shadow:0 0 40px rgba(0,0,0,.6);
}

.logo{
    text-align:center;
    font-size:26px;
    font-weight:600;
    color:#f5b942;
    margin-bottom:25px;
}

.tabs{
    display:flex;
    margin-bottom:20px;
}

.tabs button{
    flex:1;
    padding:10px;
    background:none;
    border:none;
    color:#aaa;
    cursor:pointer;
    font-weight:500;
}

.tabs button.active{
    color:#f5b942;
    border-bottom:2px solid #f5b942;
}

input{
    width:100%;
    padding:12px;
    margin:8px 0;
    border-radius:8px;
    border:1px solid #2a3147;
    background:#121728;
    color:white;
}

button.submit{
    width:100%;
    margin-top:15px;
    padding:12px;
    border:none;
    border-radius:8px;
    background:#f5b942;
    color:black;
    font-weight:600;
    cursor:pointer;
    transition:.3s;
}

button.submit:hover{
    transform:translateY(-1px);
}

.msg{
    margin-top:12px;
    text-align:center;
    font-size:14px;
    color:#ff6b6b;
}

.success{
    color:#4ade80;
}
</style>
</head>

<body>

<div class="auth-card">

<div class="logo">ZERIONX1</div>

<div class="tabs">
    <button id="loginTab" class="active">Login</button>
    <button id="signupTab">Sign Up</button>
</div>

<input type="email" id="email" placeholder="Email">
<input type="password" id="password" placeholder="Password">
<input type="password" id="confirmPassword" placeholder="Confirm Password" style="display:none;">

<button class="submit" id="submitBtn">Login</button>

<div class="msg" id="message"></div>

</div>

<script>
/* ===============================
   SUPABASE SETUP
================================*/
const SUPABASE_URL = "https://dpmqjvaylnszykujmufv.supabase.co";
const SUPABASE_KEY = "sb_publishable_S2HHT0VP1Ru6Dk63ju7V-Q_FnNfX1sd";

const supabase = window.supabase.createClient(
    SUPABASE_URL,
    SUPABASE_KEY
);

/* ===============================
   ELEMENTS
================================*/
const loginTab = document.getElementById("loginTab");
const signupTab = document.getElementById("signupTab");
const confirmPassword = document.getElementById("confirmPassword");
const submitBtn = document.getElementById("submitBtn");
const message = document.getElementById("message");

let mode = "login";

/* ===============================
   TAB SWITCH
================================*/
loginTab.onclick = () => {
    mode="login";
    confirmPassword.style.display="none";
    submitBtn.innerText="Login";
    loginTab.classList.add("active");
    signupTab.classList.remove("active");
};

signupTab.onclick = () => {
    mode="signup";
    confirmPassword.style.display="block";
    submitBtn.innerText="Create Account";
    signupTab.classList.add("active");
    loginTab.classList.remove("active");
};

/* ===============================
   AUTH FUNCTION
================================*/
submitBtn.onclick = async () => {

    message.innerText="";
    submitBtn.disabled=true;
    submitBtn.innerText="Processing...";

    const email=document.getElementById("email").value.trim();
    const password=document.getElementById("password").value;
    const confirm=confirmPassword.value;

    if(!email || !password){
        showError("Fill all fields");
        return resetBtn();
    }

    try{

        if(mode==="signup"){

            if(password!==confirm){
                showError("Passwords do not match");
                return resetBtn();
            }

            const { error } = await supabase.auth.signUp({
                email:email,
                password:password
            });

            if(error) throw error;

            showSuccess("Account created! Check email verification.");

        }else{

            const { error } = await supabase.auth.signInWithPassword({
                email:email,
                password:password
            });

            if(error) throw error;

            showSuccess("Login successful!");

            setTimeout(()=>{
                window.location.href="dashboard.html";
            },1000);
        }

    }catch(err){
        showError(err.message);
    }

    resetBtn();
};

function showError(text){
    message.className="msg";
    message.innerText=text;
}

function showSuccess(text){
    message.className="msg success";
    message.innerText=text;
}

function resetBtn(){
    submitBtn.disabled=false;
    submitBtn.innerText=(mode==="login")?"Login":"Create Account";
}

/* ===============================
   AUTO SESSION CHECK
================================*/
supabase.auth.getSession().then(({data})=>{
    if(data.session){
        window.location.href="dashboard.html";
    }
});
</script>

</body>
</html>
